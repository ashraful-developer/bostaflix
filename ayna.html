<script>
    document.addEventListener("contextmenu", (event) => event.preventDefault());

    function getQueryParam(name) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(name);
    }

    function createPlayer(sourceUrl) {
        const player = new Clappr.Player({ 
            source: sourceUrl,
            width: '100%', 
            height: '100%', 
            autoPlay: true, 
            plugins: [HlsjsPlayback, LevelSelector],
            mimeType: "application/x-mpegURL", 
            mediacontrol: { seekbar: "#ff0000", buttons: "#eee" },  
            parentId: "#player"
        });

        player.on(Clappr.Events.PLAYER_ERROR, function() {
            setTimeout(function() {
                player.load(player.options.source);
                player.play();
            }, 100);
        });

        player.on(Clappr.Events.PLAYER_STOP, function() {
            player.play();
        });

        return player;
    }

    // Get values from query
    const channelId = getQueryParam('id');
    const serverNumber = getQueryParam('server') || '1'; // default to server 1

    if (channelId) {
        const sourceUrl = `https://tvsen${serverNumber}.aynaott.com/${channelId}/index.m3u8`;
        createPlayer(sourceUrl);
    } else {
        console.error("No channel ID provided");
    }
</script>
